<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario de Libro</title>
</head>
<body>
  <form id="bookForm" enctype="form-data">
    <label for="code">Código:</label>
    <input type="text" id="code" name="code" required><br><br>

    <label for="name">Nombre:</label>
    <input type="text" id="name" name="name" required><br><br>

    <label for="editorial">Editorial:</label>
    <input type="text" id="editorial" name="editorial" required><br><br>

    <label for="author">Autor:</label>
    <input type="text" id="author" name="author" required><br><br>

    <label for="year">Año:</label>
    <input type="number" id="year" name="year" required><br><br>

    <label for="category">Categoría:</label>
    <input type="text" id="category" name="category" required><br><br>

    <label for="description">Descripción:</label><br>
    <textarea id="description" name="description" rows="4" cols="50" required></textarea><br><br>

    <label for="price">Precio:</label>
    <input type="number" step="0.01" id="price" name="price" required><br><br>

    <label for="sellPrice">Precio de venta:</label>
    <input type="number" step="0.01" id="sellPrice" name="sellPrice" required><br><br>

    <label for="stock">Stock:</label>
    <input type="number" id="stock" name="stock" required><br><br>

    <label for="image">Imagen:</label>
    <input type="file" id="file" name="file"><br><br>

    <button type="submit">Enviar</button>
  </form>

  <script>
    document.getElementById('bookForm').addEventListener('submit', function(event) {
      event.preventDefault();

      const formData = new FormData();
      formData.append('code', document.getElementById('code').value);
      formData.append('name', document.getElementById('name').value);
      formData.append('editorial', document.getElementById('editorial').value);
      formData.append('author', document.getElementById('author').value);
      formData.append('year', parseInt(document.getElementById('year').value));
      formData.append('category', document.getElementById('category').value);
      formData.append('description', document.getElementById('description').value);
      formData.append('price', parseFloat(document.getElementById('price').value));
      formData.append('sell_price', parseFloat(document.getElementById('sellPrice').value));
      formData.append('stock', parseInt(document.getElementById('stock').value));
      formData.append('id_provider', 1); // Debes obtener el ID del proveedor de alguna manera
      formData.append('rating', 4);
      formData.append('file', document.getElementById('file').files[0]);

      fetch('http://127.0.0.1:8000/api/RegistroProductos', {
        method: 'POST',
        headers:{
          'Authorization' : 'Bearer 8|i7uDLsJ2hiD1v5PnCJlFISKfXLWGQl1wP99wmVSjb8a67921'
        },
        body: formData,
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Hubo un problema al enviar los datos.');
        }
        return response.json();
      })
      .then(data => {
        console.log('Datos enviados correctamente:', data);
        // Puedes hacer algo con la respuesta del servidor si es necesario
      })
      .catch(error => {
        console.error('Error:', error);
        // Manejo de errores
      });
    });
  </script>
</body>
</html>